{% extends 'base.html' %}

{% block content %}
<div style="max-width:600px;margin:auto; padding:15px;">

    <!-- Back button -->
    <a href="{{ request.referrer or url_for('index') }}" class="btn" style="
        margin-bottom:15px; display:inline-block; padding:6px 12px; background:#6c757d; color:white; border-radius:6px; text-decoration:none;
    ">&larr; Back</a>

    <div class="card" style="padding:15px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1);">

        {% if item.image %}
        <img src="{{ url_for('static', filename='uploads/' + item.image) }}" alt="{{ item.title }}" style="width:100%; border-radius:8px; margin-bottom:15px;">
        {% endif %}

        <h2>{{ item.title }}</h2>

        {% if item.status %}
        <span class="badge" style="
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 500;
            {% if item.status.lower() == 'lost' %}background:#fee2e2;color:#991b1b;
            {% elif item.status.lower() == 'found' %}background:#d1fae5;color:#065f46;
            {% endif %}
        ">
            {{ item.status }}
        </span>
        {% endif %}

        <p class="muted" style="margin-top:5px;">Posted on: {{ item.created_at|formatdatetime }}</p>

        {% if item.description %}
        <p><strong>Description:</strong> {{ item.description }}</p>
        {% endif %}

        {% if item.location %}
        <p><strong>Location:</strong> {{ item.location }}</p>
        {% endif %}

        {% if item.contact %}
        <p><strong>Contact:</strong> {{ item.contact }}</p>
        {% endif %}

        <div style="margin-top:20px;">
            {% if current_user.is_authenticated %}
                
                {% if current_user.id == item.user_id %}
                    <a class="btn" href="{{ url_for('edit_item', item_id=item.id) }}">Edit</a>
                {% endif %}

                {% if not item.approved and current_user.is_admin %}
                    <a class="btn" href="{{ url_for('approve', item_id=item.id) }}">Approve</a>
                {% endif %}

                {% if current_user.id == item.user_id or current_user.is_admin %}
                    <form action="{% if current_user.is_admin %}{{ url_for('admin_delete_item', item_id=item.id) }}{% else %}{{ url_for('delete_item', item_id=item.id) }}{% endif %}" 
                          method="POST" style="display:inline;">
                        <button class="btn danger" type="submit" onclick="return confirm('Are you sure you want to delete this item?');">Delete</button>
                    </form>
                {% endif %}
                
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

